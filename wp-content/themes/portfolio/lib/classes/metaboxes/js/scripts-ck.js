jQuery(function(e){function r(e){var t=[];for(var n=0;n<e.length;n++)t.push(e[n].val)}var t;e(".meta_box_upload_image_button").click(function(n){n.preventDefault();var r,i;$self=e(n.target);$div=$self.closest("div.meta_box_image");if(t){t.open();return}t=wp.media({title:"Choose Image",multiple:!1,library:{type:"image"},button:{text:"Use This Image"}});t.on("select",function(){selection=t.state().get("selection");if(!selection)return;selection.each(function(e){console.log(e);var t=e.attributes.sizes.full.url,n=e.id;$div.find(".meta_box_preview_image").attr("src",t);$div.find(".meta_box_upload_image").val(n)})});t.open()});e(".meta_box_clear_image_button").click(function(){var t=e(this).parent().siblings(".meta_box_default_image").text();e(this).parent().siblings(".meta_box_upload_image").val("");e(this).parent().siblings(".meta_box_preview_image").attr("src",t);return!1});var n;e(".meta_box_upload_file_button").click(function(t){t.preventDefault();var r,i;$self=e(event.target);$div=$self.closest("div.meta_box_file_stuff");if(n){n.open();return}n=wp.media({title:"Choose File",multiple:!1,library:{type:"file"},button:{text:"Use This File"}});n.on("select",function(){selection=n.state().get("selection");if(!selection)return;selection.each(function(e){console.log(e);var t=e.attributes.url,n=e.id;$div.find(".meta_box_filename").text(t);$div.find(".meta_box_upload_file").val(t);$div.find(".meta_box_file").addClass("checked")})});n.open()});e(".meta_box_clear_file_button").click(function(){e(this).parent().siblings(".meta_box_upload_file").val("");e(this).parent().siblings(".meta_box_filename").text("");e(this).parent().siblings(".meta_box_file").removeClass("checked");return!1});e(".meta_box_repeatable_add").live("click",function(){var t=e(this).closest(".meta_box_repeatable").find("tbody tr:last-child"),n=t.clone();n.find("select.chosen").removeAttr("style","").removeAttr("id","").removeClass("chzn-done").data("chosen",null).next().remove();n.find("input.regular-text, textarea, select").val("");n.find("input[type=checkbox], input[type=radio]").attr("checked",!1);t.after(n);n.find("input, textarea, select").attr("name",function(e,t){if(typeof t!="undefined"){console.log("Name: "+t);return t.replace(/(\d+)/,function(e,t){console.log("New Value: "+(Number(e)+1));return Number(e)+1})}});n.find("*").attr("id",function(e,t){if(typeof t!="undefined"){console.log("ID: "+t);return t.replace(/(\d+)/,function(e,t){console.log("New Value: "+(Number(e)+1));return Number(e)+1})}});var r=[];e("input.repeatable_id:text").each(function(){r.push(e(this).val())});n.find("input.repeatable_id").val(Number(Math.max.apply(Math,r))+1);!e.prototype.chosen||n.find("select.chosen").chosen({allow_single_deselect:!0});return!1});e(".meta_box_repeatable_remove").live("click",function(){e(this).closest("tr").remove();return!1});e(".meta_box_repeatable tbody").sortable({opacity:.6,revert:!0,cursor:"move",handle:".hndle"});e(".sort_list").sortable({connectWith:".sort_list",opacity:.6,revert:!0,cursor:"move",cancel:".post_drop_sort_area_name",items:"li:not(.post_drop_sort_area_name)",update:function(t,n){var r=e(this).sortable("toArray"),i=e(this).attr("id");e(".store-"+i).val(r)}});e(".sort_list").disableSelection();!e.prototype.chosen||e(".chosen").chosen({allow_single_deselect:!0})});